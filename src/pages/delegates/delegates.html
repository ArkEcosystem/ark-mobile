<ion-header>

  <ion-navbar>
    <button ion-button icon-only menuToggle>
      <ion-icon name="menu"></ion-icon>
    </button>

    <ion-title *ngIf="!isSearch">{{ 'DELEGATES_PAGE.DELEGATES' | translate }}</ion-title>
    <ion-searchbar *ngIf="isSearch" (ionInput)="onInputSearch($event)" [(ngModel)]="searchQuery.username" spellcheck="false" animated="true" placeholder="{{ 'SEARCH' | translate }}"></ion-searchbar>

    <ion-buttons end>
      <button ion-button icon-only (click)="toggleSearchBar()">
        <ion-icon name="search" *ngIf="!isSearch"></ion-icon>
        <ion-icon name="close" *ngIf="isSearch"></ion-icon>
      </button>
    </ion-buttons>
  </ion-navbar>

  <ion-toolbar>
    <ion-segment [(ngModel)]="rankStatus">
      <ion-segment-button value="active">
        {{ 'DELEGATES_PAGE.ACTIVE' | translate }}
      </ion-segment-button>
      <ion-segment-button value="standBy">
        {{ 'DELEGATES_PAGE.STANDBY' | translate }}
      </ion-segment-button>
    </ion-segment>
  </ion-toolbar>

</ion-header>

<ion-content tappable>
  <ion-grid padding fixed *ngIf="delegates" [ngSwitch]="rankStatus">
    <div *ngSwitchCase="'active'" class="delegate-list">
      <ion-row (click)="openDetailModal(delegate)" nowrap text-left *ngFor="let delegate of delegates.slice(0, 51) | filterBy: searchQuery" class="delegate-item">
        <ion-col col-2 text-center><span class="rate">{{ delegate?.rate }}</span></ion-col>
        <ion-col col-7>
          {{ delegate?.username }}
          <ion-badge item-end *ngIf="isSameDelegate(delegate?.publicKey)" color="danger">{{ 'DELEGATES_PAGE.VOTE' | translate | lowercase }}</ion-badge>
        </ion-col>
        <ion-col col-3><span class="percentage">{{ delegate?.productivity | number:0 }}%</span></ion-col>
      </ion-row>
      <ion-row *ngIf="(delegates.slice(0, 51) | filterBy: searchQuery).length === 0">
        <ion-col padding text-center>
          <h6>{{ 'DELEGATES_PAGE.NO_MATCHING_SEARCH' | translate }}</h6>
        </ion-col>
      </ion-row>
    </div>
    <div *ngSwitchCase="'standBy'" class="delegate-list">
      <ion-row (click)="openDetailModal(delegate)" nowrap text-left *ngFor="let delegate of delegates.slice(51, delegates.length) | filterBy: searchQuery" class="delegate-item">
        <ion-col col-2 text-center><span class="rate">{{ delegate?.rate }}</span></ion-col>
        <ion-col col-7>
          {{ delegate?.username }}
          <ion-badge item-end *ngIf="isSameDelegate(delegate?.publicKey)" color="danger">{{ 'DELEGATES_PAGE.VOTE' | translate | lowercase }}</ion-badge>
        </ion-col>
        <ion-col col-3><span class="percentage">{{ delegate?.productivity | number:0 }}%</span></ion-col>
      </ion-row>
      <ion-row *ngIf="(delegates.slice(51, delegates.length) | filterBy: searchQuery).length === 0">
        <ion-col padding text-center>
          <h6>{{ 'DELEGATES_PAGE.NO_MATCHING_SEARCH' | translate }}</h6>
        </ion-col>
      </ion-row>
    </div>
  </ion-grid>
</ion-content>

<ion-footer>
  <ion-toolbar>
    <ion-grid>
      <ion-row align-items-center>
        <ion-col text-left><strong>{{ 'DELEGATES_PAGE.TOTAL_FORGED' | translate }}:</strong> {{ currentNetwork?.symbol }}{{ getTotalForged() | unitsSatoshi: true | number: 0.0-0 }}</ion-col>
        <ion-col text-right><strong>{{ 'DELEGATES_PAGE.DELEGATES' | translate }}:</strong> {{ delegates?.length || 0 }}</ion-col>
      </ion-row>
    </ion-grid>
  </ion-toolbar>
</ion-footer>

<pin-code [wallet]="currentWallet" (onSuccess)="generateTransaction($event)" #pinCode></pin-code>
<confirm-transaction [wallet]="currentWallet" #confirmTransaction></confirm-transaction>
